/*!
 * Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see https://ckeditor.com/legal/ckeditor-oss-license
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CKEditor5=e():(t.CKEditor5=t.CKEditor5||{},t.CKEditor5.errorNotifications=e())}(self,(()=>(()=>{"use strict";var t={d:(e,i)=>{for(var o in i)t.o(i,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:i[o]})}};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),t.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var e={};t.d(e,{default:()=>d});const{View:i}=window.CKEditor5.ui,{Rect:o,Collection:r}=window.CKEditor5.utils,{Plugin:s}=window.CKEditor5.core,n=[{header:"Oops...",description:"It seems that the editor encountered an error. Save your content and refresh the page. If the error persists, contact your site administrator.",type:"error",reactsTo:{name:"CKEditorError"}},{header:"Trial limit exceeded",description:"Your premium features trial limit for this node has been exceeded. Create a new node or contact sales@cksource.com if you want to upgrade to the full version. ",type:"error",reactsTo:{message:"trial-license-key-reached-limit"}},{header:"WProofreader Authorization Error",description:"Some problems occurred during WProofreader initialization. Check the WProofreader plugin configuration.",type:"error",reactsTo:{message:"wproofreader-service-id-error"}},{header:"WProofreader usage limit exceeded",description:"The daily limit for the number of words checked using the WProofreader grammar and spell checker has been reached. Please contact your site administrator for help. Access to the service will resume at 00:00 UTC.",type:"error",reactsTo:{message:"wproofreader-usage-limit-error"}},{header:"WProofreader Error",description:"You have no permission to access the WProofreader proxy.",type:"error",reactsTo:{message:"wproofreader-permission-error"}}];class a extends i{constructor(e,i){super(e),this.reactsTo=i.reactsTo,this.closeNotificationButton=null,this.set("_editable",null),this.set("isVisible",!1),this.set("positionBottom","20px"),this.set("positionRight","15px"),this.createTemplate(i),this.render(),this.on("change:isVisible",(()=>this._updateNotificationPosition())),this.listenTo(t.g.document,"scroll",((t,e)=>{this.isVisible&&this._updateNotificationPosition()}))}createTemplate(t){const e=this.bindTemplate,i=this._createNotificationHeader(t.header,t.type),o=this._createNotificationDescription(t.description),r=this._createCloseNotificationButton();this.setTemplate({tag:"div",attributes:{class:["ck-notification",`ck-notification__${t.type}`,e.if("isVisible","ck-hidden",(t=>!t))],style:{position:"absolute",bottom:e.to("positionBottom"),right:e.to("positionRight"),"z-index":999}},children:[i,o,r]})}show(){this.isVisible=!0}hide(){this.isVisible=!1}_createNotificationHeader(t,e){const o=new i;return o.setTemplate({tag:"h4",attributes:{class:["ck-notification__header",`ck-notification__header-${e}`]},children:[t]}),o}_createNotificationDescription(t){const e=new i;return e.setTemplate({tag:"p",attributes:{class:["ck-notification__description"]},children:[t]}),e}_createCloseNotificationButton(){const t=new i,e=t.bindTemplate;return t.setTemplate({tag:"span",attributes:{class:["ck-notification__close"]},children:["x"],on:{click:e.to((t=>this.fire("closeNotification")))}}),t}_updateNotificationPosition(){const t=this._editable;if(!t)return;const e=new o(t).getVisible(),i=window.innerHeight,r=e.bottom-i;e.top>=i-100||(e.bottom>i?this.set("positionBottom",`${r+20}px`):this.set("positionBottom","20px"))}}const c=class extends s{constructor(...t){super(...t),this.availableNotifications=new r,this.activeNotification=null}static get pluginName(){return"ErrorNotifications"}init(){const t=this.editor;this._setupNotifications(n),this.set("_editable",null),t.ui.once("ready",(()=>this.set("_editable",t.ui.view.editable.element))),this._attachListeners()}destroy(){this.activeNotification&&(this.activeNotification.hide(),this.editor.ui.view.main.remove(this.activeNotification)),this.activeNotification=null,this._detachListeners(),super.destroy()}_setupNotifications(t){for(const e of t){const t=new a(this.editor.locale,e);t.bind("_editable").to(this,"_editable"),t.on("closeNotification",(()=>{t.hide(),this.activeNotification=null,this.editor.ui.view.main.remove(t),this.editor.editing.view.focus()})),this.availableNotifications.add(t)}}_attachListeners(){window.addEventListener("error",this._handleError.bind(this)),window.addEventListener("unhandledrejection",this._handleError.bind(this))}_detachListeners(){window.removeEventListener("error",this._handleError.bind(this)),window.removeEventListener("unhandledrejection",this._handleError.bind(this))}_handleError(t){let e=null;const i=new r;if(!this.activeNotification&&t.error){for(const e of this.availableNotifications){const o=e.reactsTo;for(const r in o)t.error[r]&&t.error[r].includes(o[r])&&i.add(e)}e=i.length>1?i.find((t=>t.reactsTo.message)):i.first,e&&(this.activeNotification=e,this.activeNotification.show(),this.editor.ui.view.main.add(this.activeNotification))}}},d={ErrorNotifications:c};return e=e.default})()));